define(["jquery"],function(t){function i(t){var i=this;this.ct=t,console.log(this.ct),this.init(),this.start(),this.ct.find(".load").on("click",function(){i.start()})}return i.prototype.init=function(){var t=this;this.length=10,this.pageIndex=10,this.content=this.ct.find(".content"),this.itemWdith=this.ct.find(".item").outerWidth(!0),this.itemCol=parseInt(this.content.width()/this.itemWdith),this.itemHeightArr=[];for(var i=0;i<this.itemCol;i++)t.itemHeightArr[i]=0;this.isDataArrive=!0},i.prototype.start=function(){var i=this;i.getNews(function(e){i.isDataArrive=!0,t.each(e,function(t,e){var n=i.createEle(e);n.find("img").on("load",function(){i.content.append(n),console.log(n,"loaded..."),i.waterFallPlace(n)})})}),i.isDataArrive=!1},i.prototype.waterFallPlace=function(t){for(var i=this,e=0,n=i.itemHeightArr[0],o=0;o<i.itemHeightArr.length;o++)i.itemHeightArr[o]<n&&(e=o,n=i.itemHeightArr[o]);t.css({left:i.itemWdith*e,top:n,opacity:1}),i.itemHeightArr[e]+=t.outerHeight(!0),i.content.height(Math.max.apply(null,i.itemHeightArr))},i.prototype.check=function(i){var e=t(window).height(),n=t(window).scrollTop(),o=i.offset().top,r=i.outerHeight(!0);return e+n>o&&n<o+r},i.prototype.createEle=function(i){var e="";return e+='<li class="item"><a href="'+i.url+'"><img src="'+i.img_url+'" alt=""><h4>'+i.short_name+"</h4><p>"+i.short_intro+"</p></a></li>",t(e)},i.prototype.getNews=function(i){var e=this;t.ajax({url:"https://platform.sina.com.cn/slide/album_tech",jsonp:"jsoncallback",dataType:"jsonp",data:{app_key:1271687855,num:e.length,page:e.pageIndex}}).done(function(t){t&&t.status&&"0"===t.status.code?(i(t.data),e.pageIndex++):console.log("get error data")}).fail(function(){console.log("系统错误")})},i});